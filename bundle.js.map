{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://otus-js-baklikova-5-ts/./src/index.ts","webpack://otus-js-baklikova-5-ts/./src/GameView.ts","webpack://otus-js-baklikova-5-ts/./src/GameField.ts","webpack://otus-js-baklikova-5-ts/./src/Game.ts"],"sourcesContent":["import { Game } from \"./Game\";\nimport { GameField } from \"./GameField\";\nimport { GameView } from \"./GameView\";\nimport \"./styles.css\";\n\nconst el = document.getElementById(\"app\") as HTMLElement;\n\nconst gameView = new GameView(el);\nconst gameField = new GameField(5, 5);\nnew Game(gameField, gameView, 1000);\n","import { Cell } from \"./types/Cell\";\nimport { IGameField } from \"./GameField\";\n\nexport interface IGameView {\n  updateGameField: (field: Cell[][]) => void;\n  updateGameState: (state: {\n    width?: number;\n    height?: number;\n    isRunning?: boolean;\n    stepDurationMs?: number;\n  }) => void;\n  onCellClick: (cb: (x: number, y: number) => void) => void;\n  onGameStateChange: (cb: (newState: boolean) => void) => void;\n  onFieldSizeChange: (cb: (width: number, height: number) => void) => void;\n  getDuration: ()=>number;\n}\n\nexport class GameView implements IGameView {\n  el: HTMLElement;\n  onCC: (x: number, y: number) => void;\n  onGSC: (newState: boolean) => void;\n  onFSC: (width: number, height: number) => void;\n  state: { width?: number; height?: number; isRunning?: boolean; stepDurationMs?: number } = {};\n  constructor(element: HTMLElement) {\n    this.el = element;\n    this.el.innerHTML =\n      \"<div class='gameField'></div><div class='gameControls'></div>\";\n    this.onCC = (x: number, y: number) => void {};\n    this.onGSC = (newState: boolean) => void {};\n    this.onFSC = (width: number, height: number) => void {};\n    const gameControls = this.el.querySelector(\n      \".gameControls\"\n    ) as HTMLDivElement;\n    const buttonEl = document.createElement(\"button\");\n    buttonEl.innerHTML = \"Play\";\n    buttonEl.className = \"run-button run-button--stopped\";\n    buttonEl.addEventListener(\"click\", (ev) => {\n      this.onGSC(buttonEl.innerHTML === \"Play\");\n    });\n    gameControls.appendChild(buttonEl);\n    const inputW = document.createElement(\"input\");\n    inputW.type = \"number\";\n    inputW.className = \"field-size field-size--width\";\n    gameControls.appendChild(inputW);\n    const inputH = document.createElement(\"input\");\n    inputH.type = \"number\";\n    inputH.className = \"field-size field-size--height\";\n    gameControls.appendChild(inputH);\n    inputW.addEventListener(\"change\", (ev) => {\n      this.onFSC(inputW.valueAsNumber, inputH.valueAsNumber);\n    });\n    inputH.addEventListener(\"change\", (ev) => {\n      this.onFSC(inputW.valueAsNumber, inputH.valueAsNumber);\n    });\n    const inputR = document.createElement(\"input\");\n    inputR.type = \"range\";\n    inputR.className = \"field-range\";\n    gameControls.appendChild(inputR);\n    inputR.addEventListener(\"change\", (ev) => {\n      this.state.stepDurationMs=inputR.valueAsNumber;\n    });\n  }\n\n  updateGameField(field: Cell[][]) {\n    const gameField = this.el.querySelector(\".gameField\") as HTMLDivElement;\n    gameField.innerHTML = \"\";\n    const tableEl = document.createElement(\"table\");\n    gameField.appendChild(tableEl);\n    for (let row = 0; row < field.length; row++) {\n      const tr = document.createElement(\"tr\");\n      tableEl.appendChild(tr);\n      for (let col = 0; col < field[row].length; col++) {\n        const td = document.createElement(\"td\");\n        if (field[row][col] === 1) {\n          td.className = \"cell cell--alive\";\n        } else {\n          td.className = \"cell cell--dead\";\n        }\n        td.addEventListener(\"click\", (ev) => {\n          this.onCC(col, row);\n        });\n        tr.appendChild(td);\n      }\n    }\n  }\n\n  updateGameState(state: {\n    width?: number;\n    height?: number;\n    isRunning?: boolean;\n    stepDurationMs?: number;\n  }) {\n    this.state = {\n      ...this.state,\n      ...state,\n    };\n    if (typeof this.state.width === \"number\" && !isNaN(this.state.width)) {\n      const inputW = this.el.querySelector(\n        \"input[type='number'].field-size.field-size--width\"\n      ) as HTMLInputElement;\n      inputW.valueAsNumber = this.state.width;\n    }\n    if (typeof this.state.height === \"number\" && !isNaN(this.state.height)) {\n      const inputH = this.el.querySelector(\n        \"input[type='number'].field-size.field-size--height\"\n      ) as HTMLInputElement;\n      inputH.valueAsNumber = this.state.height;\n    }\n    const inputR = this.el.querySelector(\n        \"input[type='range']\"\n    ) as HTMLInputElement;\n    if (typeof this.state.stepDurationMs === \"number\" && !isNaN(this.state.stepDurationMs)) {\n      inputR.max = String(this.state.stepDurationMs*2);\n    }\n    const button = this.el.querySelector(\".run-button\") as HTMLButtonElement;\n    if (this.state.isRunning ?? false) {\n      button.className = \"run-button run-button--runned\";\n      button.innerHTML = \"Stop\";\n      inputR.disabled=true;\n    } else {\n      button.className = \"run-button run-button--stopped\";\n      button.innerHTML = \"Play\";\n      inputR.disabled=false;\n    }\n  }\n\n  onCellClick(cb: (x: number, y: number) => void) {\n    this.onCC = cb;\n  }\n\n  onGameStateChange(cb: (newState: boolean) => void) {\n    this.onGSC = cb;\n  }\n\n  onFieldSizeChange(cb: (width: number, height: number) => void) {\n    this.onFSC = cb;\n  }\n\n  getDuration(){\n    return this.state.stepDurationMs as number;\n  }\n}\n","import { Cell } from \"./types/Cell\";\n\nexport interface IGameField {\n  getState: () => Cell[][];\n  toggleCellState: (x: number, y: number) => void;\n  nextGeneration: () => void;\n  setSize: (width: number, height: number) => void;\n}\n\nexport class GameField implements IGameField {\n  field: Cell[][] = [];\n  constructor(width = 0, height = 1) {\n    const field = [];\n    for (let row = 0; row < height; row++) {\n      field[row] = [] as number[];\n      for (let col = 0; col < width; col++) {\n        field[row][col] = 0;\n      }\n      this.field = field;\n    }\n  }\n\n  getAliveCellCount(x: number, y: number): number {\n    let count = 0;\n    for (let row = y - 1; row <= y + 1; row++) {\n      for (let col = x - 1; col <= x + 1; col++) {\n        if (!(col === x && row === y) && this.field[row]?.[col] === 1) {\n          count++;\n        }\n      }\n    }\n    return count;\n  }\n\n  nextGeneration() {\n    for (let row = 0; row < this.field.length; row++) {\n      for (let col = 0; col < this.field[row].length; col++) {\n        const ACount: number = this.getAliveCellCount(col, row);\n\n        if (ACount === 3 && this.field[row][col] === 0) {\n          this.field[row][col] = 1;\n        }\n        if (ACount !== 3 && ACount !== 2 && this.field[row][col] === 1) {\n          this.field[row][col] = 0;\n        }\n      }\n    }\n  }\n\n  getState() {\n    return this.field;\n  }\n\n  toggleCellState(x: number, y: number) {\n    if (this.field[y][x] === 1) {\n      this.field[y][x] = 0;\n    } else {\n      this.field[y][x] = 1;\n    }\n  }\n\n  setSize(width: number, height: number) {\n    const newField: Cell[][] = [];\n\n    for (let row = 0; row < height; row++) {\n      newField.push([]);\n      for (let col = 0; col < width; col++) {\n        if (\n          this.field[row] !== undefined &&\n          this.field[row][col] !== undefined\n        ) {\n          newField[row][col] = this.field[row][col];\n        } else {\n          newField[row][col] = 0;\n        }\n      }\n    }\n    this.field = newField;\n  }\n}\n","import { IGameField } from \"./GameField\";\nimport { IGameView } from \"./GameView\";\n\nexport class Game {\n  timerId?: NodeJS.Timer;\n  constructor(\n    gameField: IGameField,\n    gameView: IGameView,\n    stepDurationMs: number=1000\n  ) {\n    const state = gameField.getState();\n    gameField.setSize(state[0].length, state.length);\n    gameView.updateGameField(state);\n    gameView.updateGameState({\n      isRunning: false,\n      width: state[0].length,\n      height: state.length,\n      stepDurationMs: stepDurationMs\n    });\n\n    gameView.onCellClick((x: number, y: number) => {\n      gameField.toggleCellState(x, y);\n      gameView.updateGameField(gameField.getState());\n    });\n    gameView.onGameStateChange((newState: boolean) => {\n      if (newState) {\n        gameField.nextGeneration();\n        gameView.updateGameField(gameField.getState());\n        this.timerId = setInterval(() => {\n          gameField.nextGeneration();\n          gameView.updateGameField(gameField.getState());\n        }, gameView.getDuration());\n      } else {\n        gameView.updateGameField(gameField.getState());\n        clearInterval(this.timerId);\n      }\n      gameView.updateGameState({ isRunning: newState });\n    });\n    gameView.onFieldSizeChange((width: number, height: number) => {\n      gameField.setSize(width, height);\n      gameView.updateGameField(gameField.getState());\n      gameView.updateGameState({ width, height });\n    });\n  }\n}\n"],"names":["el","document","getElementById","gameView","state","constructor","element","this","innerHTML","onCC","x","y","onGSC","newState","onFSC","width","height","gameControls","querySelector","buttonEl","createElement","className","addEventListener","ev","appendChild","inputW","type","inputH","valueAsNumber","inputR","stepDurationMs","updateGameField","field","gameField","tableEl","row","length","tr","col","td","updateGameState","isNaN","max","String","button","isRunning","disabled","onCellClick","cb","onGameStateChange","onFieldSizeChange","getDuration","getAliveCellCount","count","nextGeneration","ACount","getState","toggleCellState","setSize","newField","push","undefined","timerId","setInterval","clearInterval"],"sourceRoot":""}