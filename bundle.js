!function(){"use strict";class e{field=[];constructor(e=0,t=1){const i=[];for(let n=0;n<t;n++){i[n]=[];for(let t=0;t<e;t++)i[n][t]=0;this.field=i}}getAliveCellCount(e,t){let i=0;for(let n=t-1;n<=t+1;n++)for(let l=e-1;l<=e+1;l++)l===e&&n===t||1!==this.field[n]?.[l]||i++;return i}nextGeneration(){let e=!1;for(let t=0;t<this.field.length;t++)for(let i=0;i<this.field[t].length;i++){const n=this.getAliveCellCount(i,t);3===n&&0===this.field[t][i]&&(0===this.field[t][i]&&(e=!0),this.field[t][i]=1),3!==n&&2!==n&&1===this.field[t][i]&&(1===this.field[t][i]&&(e=!0),this.field[t][i]=0)}return e}getState(){return this.field}toggleCellState(e,t){1===this.field[t][e]?this.field[t][e]=0:this.field[t][e]=1}setSize(e,t){const i=[];for(let n=0;n<t;n++){i.push([]);for(let t=0;t<e;t++)void 0!==this.field[n]&&void 0!==this.field[n][t]?i[n][t]=this.field[n][t]:i[n][t]=0}this.field=i}}class t{constructor(e,t){this.state=t,this.el=e,this.el.innerHTML="<div class='gameField'></div><div class='gameControls'></div>",this.onCellClickCB=(e,t)=>{},this.onGameStateChangeCB=e=>{},this.onFieldSizeChangeCB=(e,t)=>{};const i=this.el.querySelector(".gameControls"),n=document.createElement("button");n.innerHTML="Play",n.className="run-button run-button--stopped",n.addEventListener("click",(e=>{this.onGameStateChangeCB("Play"===n.innerHTML)})),i.appendChild(n);let l=[document.createElement("input"),document.createElement("input")];for(let e=0;e<2;e++)l[e].type="number",l[e].className=0===e?"field-size field-size--width":"field-size field-size--height",i.appendChild(l[e]),l[e].addEventListener("change",(e=>{this.onFieldSizeChangeCB(l[0].valueAsNumber,l[1].valueAsNumber)}));const a=document.createElement("input");a.type="range",a.className="field-range",i.appendChild(a),a.addEventListener("change",(e=>{this.state.stepDurationMs=a.valueAsNumber}))}updateGameField(e){const t=this.el.querySelector(".gameField");t.innerHTML="";const i=document.createElement("table");t.appendChild(i);for(let t=0;t<e.length;t++){const n=document.createElement("tr");i.appendChild(n);for(let i=0;i<e[t].length;i++){const l=document.createElement("td");1===e[t][i]?l.className="cell cell--alive":l.className="cell cell--dead",l.addEventListener("click",(e=>{this.onCellClickCB(i,t)})),n.appendChild(l)}}}updateGameState(e){this.state={...this.state,...e},this.el.querySelector(".field-size--width").valueAsNumber=this.state.width,this.el.querySelector(".field-size--height").valueAsNumber=this.state.height;const t=this.el.querySelector("input[type='range']");"number"!=typeof e.stepDurationMs||isNaN(e.stepDurationMs)||(t.max=String(2*e.stepDurationMs),t.valueAsNumber=e.stepDurationMs);const i=this.el.querySelector(".run-button");this.state.isRunning?(i.className="run-button run-button--runned",i.innerHTML="Stop",t.disabled=!0):(i.className="run-button run-button--stopped",i.innerHTML="Play",t.disabled=!1)}onCellClick(e){this.onCellClickCB=e}onGameStateChange(e){this.onGameStateChangeCB=e}onFieldSizeChange(e){this.onFieldSizeChangeCB=e}getDuration(){return this.state.stepDurationMs}}const i=document.getElementById("app");new class{constructor(i,n,l,a=1e3){const s=new t(i,{width:n,height:l,isRunning:!1,stepDurationMs:a}),d=new e(5,5),r=d.getState();d.setSize(r[0].length,r.length),s.updateGameField(r),s.updateGameState({isRunning:!1,width:r[0].length,height:r.length,stepDurationMs:a}),s.onCellClick(((e,t)=>{d.toggleCellState(e,t),s.updateGameField(d.getState())})),s.onGameStateChange((e=>{e?(d.nextGeneration(),s.updateGameField(d.getState()),this.timerId=setInterval((()=>{d.nextGeneration()?s.updateGameField(d.getState()):(clearInterval(this.timerId),s.updateGameState({isRunning:!1}))}),s.getDuration())):(s.updateGameField(d.getState()),clearInterval(this.timerId)),s.updateGameState({isRunning:e})})),s.onFieldSizeChange(((e,t)=>{d.setSize(e,t),s.updateGameField(d.getState()),s.updateGameState({width:e,height:t})}))}}(i,5,5,1e3)}();
//# sourceMappingURL=bundle.js.map